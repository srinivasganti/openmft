# Session: 2026-02-18 08:20 - Fix Column Toggle Dropdown Order

## Summary
Fixed the "Show Columns" dropdown to list columns in DSL-declared order instead of arbitrary map key order. Added a `column_order` field to the DataTable Action entity, set by the merge transformer before columns are converted to a map.

## Changes Made

### Modified Files
| File | Description |
|------|-------------|
| `lib/openmft/ui/data_table/action.ex` | Added `column_order` schema field (list of atoms, hidden from docs) |
| `lib/openmft/ui/dsl/transformers/merge_data_table_actions.ex` | Captures `column_order` from the ordered column entity list before `merge_columns` converts it to a map |
| `lib/openmft_web/column_toggle.ex` | Changed `init/2` to use `config.column_order` instead of `Map.keys(config.columns)` |

## Technical Details

**Root cause:** `ColumnToggle.init/2` used `Map.keys(config.columns)` to get all column names. Since `config.columns` is a map (built by `merge_columns` for O(1) lookup), key order is not guaranteed and didn't match the DSL declaration order.

**Fix:** Added a `column_order` field to the Action entity that preserves the DSL-declared order. The `merge_data_table_actions` transformer captures `Enum.map(action.columns, & &1.name)` from the ordered entity list before `merge_columns` converts it to a map. `ColumnToggle.init/2` then reads `config.column_order` for a stable, predictable order.

## Status
- All 65 tests pass
- Dropdown now shows columns in DSL order: Name, Email, Phone Number, Billing Id, Modified By, Description, Status, Last Modified
